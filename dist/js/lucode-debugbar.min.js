!function(){"use strict";var n=angular.module("lucode.debugbar",["LocalStorageModule"]),i={},e=angular.forEach,t=function(n,i,t){var a={};return e(n,function(n,e){a[e]=i.call(t,n,e)}),a},a=function(n,i){return n.setData=n.setData||angular.noop,n.appendData=n.appendData||angular.noop,n.init=n.init||angular.noop,n.template=n.template||"",n.icon=n.icon||"",n.tabTemplate=n.tabTemplate||"",n.isTab=!!n.tabTemplate,n.position=n.position||"",n.init(i)};n.provider("debugService",function(){var n={enabled:!0};this.setEnabled=function(i){return n.enabled=i,this},this.registerPlugin=function(n,e){return i[n]=e,this},this.$get=function(){return{isEnabled:function(){return n.enabled},getPlugin:function(n){return i[n]&&i[n].publicApi}}}}),n.directive("debugPlugins",["$compile","$injector",function(n,i){return{restrict:"E",scope:{plugins:"="},replace:!0,require:["^debug","debugPlugins"],template:'<div><ul class="debugbar__nav"></ul><div class="debugbar__tabs"></div></div>',controller:function(){var n;this.init=function(i){n=i},this.toggleTab=function(i){var t=!i.active;e(this.plugins,function(n){n.isTab&&(n.active=!1)}),i.isTab&&(i.active=t,n.tabVisible=t)}},controllerAs:"debugPlugins",link:function(e,u,r,l){var s=l[0],o=l[1],c=u.find(".debugbar__tabs"),g=u.find("ul");o.init(s),o.plugins=t(e.plugins,function(t){var u,r,l=i.invoke(t),s=e.$new();return s.plugin=l,t.publicApi=a(l,s),g.append(u=angular.element(['<li class="',"right"===l.position?"debugbar--right":"",'" ng-class="{ active: plugin.active }"',l.isTab?' ng-click="debugPlugins.toggleTab(plugin)"':"",">",'<i ng-if="plugin.icon" class="',l.icon,'"></i> ',l.template," </li>"].join(""))),c.append(r=angular.element(['<div ng-if="plugin.active">',l.tabTemplate,"</div>"].join(""))),n(r)(s),n(u)(s),l})}}}]),n.directive("debug",["debugService","localStorageService",function(n,e){var t="debug_show";return{restrict:"E",scope:{},replace:!0,controller:function(){this.show="true"===e.get(t),this.plugins=i,this.tabVisible=!1,this.toggle=function(){this.show=!this.show,this.show||(this.tabVisible=!1),e.set(t,this.show)}},controllerAs:"debugCtrl",template:['<div class="debugbar" ng-class="{ show: debugCtrl.show, \'show-tab\': debugCtrl.tabVisible }">','<button class="btn btn-primary btn-sm debugbar__btn" ng-click="debugCtrl.toggle()"><i class="fa fa-cog"></i></button>','<debug-plugins plugins="debugCtrl.plugins"></debug-plugins>',"</div>"].join(""),compile:function(i){return function(){n.isEnabled()||i.remove()}}}}]),n.config(["debugServiceProvider",function(n){n.registerPlugin("watches",["$timeout","$document",function(n,i){var t=function(n){var i=0;return n.data().hasOwnProperty("$scope")&&e(n.data().$scope.$$watchers,function(){i+=1}),e(n.children(),function(n){i+=t(angular.element(n))}),i};return{init:function(e){var a;e.running=!1,e.watches=0,e.runStop=function(){e.running=!e.running,e.running?a=n(function u(){e.watches=t(angular.element(i[0].getElementsByTagName("html"))),a=n(u,1e3)},1e3):n.cancel(a)}},position:"right",template:['<a href="" ng-click="runStop()">','<i class="fa fa-eye"></i> ',"<i class=\"fa\" ng-class=\"{'fa-pause': running, 'fa-play': !running }\"></i>","{{ watches }}","</a>"].join("")}}]).registerPlugin("listeners",["$timeout","$document",function(n,i){var t=function(n){var i=0;return n.data().hasOwnProperty("$scope")&&e(n.data().$scope.$$listeners,function(){i+=1}),e(n.children(),function(n){i+=t(angular.element(n))}),i};return{init:function(e){var a;e.running=!1,e.listeners=0,e.runStop=function(){e.running=!e.running,e.running?a=n(function u(){e.listeners=t(angular.element(i[0].getElementsByTagName("html"))),a=n(u,1e3)},1e3):n.cancel(a)}},position:"right",template:['<a href="" ng-click="runStop()">','<i class="fa fa-headphones"></i> ',"<i class=\"fa\" ng-class=\"{'fa-pause': running, 'fa-play': !running }\"></i> ","{{ listeners }}","</a>"].join("")}}])}])}();